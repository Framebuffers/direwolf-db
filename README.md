# üê∫ direwolf-db

Docker container with a PostgreSQL database, Prisma ORM and a blank Node app template.

## ‚ö†Ô∏è WARNING

This demo is hard-wired to listen to a single PostgreSQL URL. Rename the provided `.env.example` to `.env` before starting the container.
This project, as well as this file, **IS NOT MEANT FOR PRODUCTION USE**. You have been warned.

## üèóÔ∏è Build
- You need Docker and `docker-compose`
- Run `docker-compose up`
- Done!

# ‚õ¥Ô∏è Ports
- `localhost:3000`: Blank Node.js project.
- `localhost:3001`: Grafana dashboard.
- `localhost:5555`: Prisma Studio ORM.

## üìÇ Schema

Wolfpack's format follows the following schema:

- `id`: autoincremental integer key.
- `documentName`: the equivalent of `Document.Title` of a RVT file. Describes the name of the document as shown on the title bar.
- `fileOrigin`: the file path to the RVT file. Blank if it has never been saved or if it is workshared.
- `documentVersion`: a GUID generated by Revit for every time a Document has been saved. It is used to track the evolution of a Revit project, and it can be used to check differences (a _delta_) between two different savestates.
- `wasCompleted`: true if the test was completed successfully.
- `timeTaken`: time between the `Hunt()` method execution and the time the Wolfpack is being pushed to the `WolfpackDB`.
- `createdAt`: timestamp generated when the Wolfpack has been created.
- `guid`: unique identifier generated by Direwolf for each Wolfpack.
- `resultCount`: count of Prey objects inside of the Wolfpack.
- `testName`: name of the query.
- `results`: a JSON string containing each serialised Prey object.

## üéõÔ∏è Dashboard

![Screenshot 2025-04-01 012222](https://github.com/user-attachments/assets/b557fd6b-f5ff-4d89-9f5f-7b61d3f15aa2)

This database includes a Grafana dashboard at `localhost:3001`. It is configured to read from `ModelInfo` tests (Send Model to DB). Every `ModelInfo` test will be queried for:
- Views inside Document
- Views not in Sheets
- Annotative Elements
- External References
- Model Groups
- Detail Groups
- Design Options
- Level Count
- Grid Count
- Warning Count
- Unenclosed Rooms
- Viewports
- Unconnected Ducts
- Unconnected Pipes
- Unconnected Electrical Fixtures
- Non-native styles
- Flipped Elements
- Elements per Workset
- Time taken for a complete query.

## üìÉ To do

- Change JSON to BSON.
- Create tables for elements, parameters and document results.
